#open the new machine

sudo -s
apt-get install s3cmd
s3cmd --configure
s3cmd get s3://bioinfobiobureau/input/Pipergaudichaudia_S45_L008_R*_001.fastq.gz
s3cmd get s3://bioinfobiobureau/input/Myrceugeniamyrcio_S46_L008_R*_001.fastq.gz
s3cmd get s3://bioinfobiobureau/input/Sphagneticolatrilo_S44_L008_R*_001.fastq.gz
apt-get update
apt-get install g++
apt-get install make
apt-get install zlib1g-dev
apt-get install libncurses5-dev libncursesw5-dev
wget https://github.com/trinityrnaseq/trinityrnaseq/releases
cd trinityrnaseq-2.2.0
make

nohup /home/ubuntu/scripts/FastQC/./fastqc Myrceugeniamyrcio_S46_L008_R2_001.fastq.gz &
nohup /home/ubuntu/scripts/FastQC/./fastqc Myrceugeniamyrcio_S46_L008_R1_001.fastq.gz &
nohup /home/ubuntu/scripts/FastQC/./fastqc Sphagneticolatrilo_S44_L008_R2_001.fastq.gz &
nohup /home/ubuntu/scripts/FastQC/./fastqc Sphagneticolatrilo_S44_L008_R1_001.fastq.gz &

apt-get install bowtie

nohup /home/ubuntu/trinityrnaseq-2.2.0/./Trinity --seqType fq --trimmomatic --SS_lib_type RF --CPU 6 --max_memory 30G --normalize_reads --normalize_by_read_set --left /home/ubuntu/rna-seq/Pipergaudichaudia_S45_L008_R1_001.fastq.gz --right /home/ubuntu/rna-seq/Pipergaudichaudia_S45_L008_R2_001.fastq.gz --output /home/ubuntu/rna-seq/trinity_piper
nohup cdhit-est -i Trinity.piper.fasta -o Trinity.piper.fasta.cdhit100 -c 1.0 -T 3
blastall -p blastx -i Trinity.piper.fasta.cdhit100 -d Protein_Plant_Limonene_hydroxylases.fasta -o Trinity.piper100.Protein_Plant_Limonene_hydroxylases.blastx1e05 -e 1e-05

#I'm going to run blastx (with swissprot) in the output from cdhit splited in 3 files, in three different amazon instances for each species.

perl /home/bioma/scripts/split_multifasta.pl --input_file=Trinity.piper.fasta.cdhit100 --seqs_per_file=68978 --output_dir=.

makeblastdb -in uniprot_sprot.fasta -dbtype prot
nohup blastx -query Trinity.piper.fasta.cdhit100.1 -db uniprot_sprot.fasta -evalue 1e-05 -num_threads 8 -out Trinity.piper.cdhit100.1.uniprot.blastx1e05

makeblastdb -in uniprot_sprot.fasta -dbtype prot
nohup blastx -query Trinity.piper.fasta.cdhit100.2 -db uniprot_sprot.fasta -evalue 1e-05 -num_threads 8 -out Trinity.piper.cdhit100.2.uniprot.blastx1e05

makeblastdb -in uniprot_sprot.fasta -dbtype prot
nohup blastx -query Trinity.piper.fasta.cdhit100.3 -db uniprot_sprot.fasta -evalue 1e-05 -num_threads 8 -out Trinity.piper.cdhit100.3.uniprot.blastx1e05

nohup /home/ubuntu/trinityrnaseq-2.2.0/./Trinity --seqType fq --trimmomatic --SS_lib_type RF --CPU 6 --max_memory 30G --normalize_reads --normalize_by_read_set --left /home/ubuntu/rna-seq/Sphagneticolatrilo_S44_L008_R1_001.fastq.gz --right /home/ubuntu/rna-seq/Sphagneticolatrilo_S44_L008_R2_001.fastq.gz --output /home/ubuntu/rna-seq/trinity_shpagneti/
nohup cdhit-est -i Trinity.sphag.fasta -o Trinity.sphag.fasta.cdhit100 -c 1.0 -T 3

perl /home/bioma/scripts/split_multifasta.pl --input_file=Trinity.sphag.fasta.cdhit100 --seqs_per_file=136201 --output_dir=.

makeblastdb -in uniprot_sprot.fasta -dbtype prot
nohup blastx -query Trinity.sphag.fasta.cdhit100.1 -db uniprot_sprot.fasta -evalue 1e-05 -num_threads 8 -out Trinity.sphag.cdhit100.1.uniprot.blastx1e05


nohup /home/ubuntu/trinityrnaseq-2.2.0/./Trinity --seqType fq --trimmomatic --SS_lib_type RF --CPU 6 --max_memory 30G --normalize_reads --normalize_by_read_set --left /home/ubuntu/rna-seq/Myrceugeniamyrcio_S46_L008_R1_001.fastq.gz --right /home/ubuntu/rna-seq/Myrceugeniamyrcio_S46_L008_R2_001.fastq.gz --output /home/ubuntu/rna-seq/trinity_Myrceu
nohup cdhit-est -i Trinity.Myr.fasta -o Trinity.Myr.fasta.cdhit100 -c 1.0 -T 6
